<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="The CloudNativePG Contributors" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Release notes for CloudNativePG 1.20 - CloudNativePG v1.24</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../css/override.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Release notes for CloudNativePG 1.20";
        var mkdocs_page_input_path = "release_notes/old/v1.20.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> CloudNativePG v1.24
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">CloudNativePG</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../before_you_start/">Before You Start</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../use_cases/">Use cases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../architecture/">Architecture</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../installation_upgrade/">Installation and upgrades</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../quickstart/">Quickstart</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../image_catalog/">Image Catalog</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../bootstrap/">Bootstrap</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../database_import/">Importing Postgres databases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../security/">Security</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../instance_manager/">Postgres instance manager</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../scheduling/">Scheduling</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../resource_management/">Resource management</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../failure_modes/">Failure Modes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../rolling_update/">Rolling Updates</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../replication/">Replication</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../backup/">Backup</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../backup_barmanobjectstore/">Backup on object stores</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../wal_archiving/">WAL archiving</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../backup_volumesnapshot/">Backup on volume snapshots</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../recovery/">Recovery</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../service_management/">Service Management</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../postgresql_conf/">PostgreSQL Configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../declarative_role_management/">Database Role Management</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../tablespaces/">Tablespaces</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../operator_conf/">Operator configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../cluster_conf/">Instance pod configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../storage/">Storage</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../labels_annotations/">Labels and annotations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../monitoring/">Monitoring</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../logging/">Logging</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../certificates/">Certificates</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../ssl_connections/">Client TLS/SSL connections</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../applications/">Connecting from an application</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../connection_pooling/">Connection pooling</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../replica_cluster/">Replica clusters</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../kubernetes_upgrade/">Kubernetes Upgrade and Maintenance</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../kubectl-plugin/">Kubectl Plugin</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../failover/">Automated failover</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting/">Troubleshooting</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../fencing/">Fencing</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../declarative_hibernation/">Declarative hibernation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../postgis/">PostGIS</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../e2e/">End-to-End Tests</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../container_images/">Container Image Requirements</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../operator_capability_levels/">Operator capability levels</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../controller/">Custom Pod Controller</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../samples/">Examples</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../networking/">Networking</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../benchmarking/">Benchmarking</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../faq/">Frequently Asked Questions (FAQ)</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../cloudnative-pg.v1/">API Reference</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../supported_releases/">Supported releases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../preview_version/">Preview Versions</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../">Release notes</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Appendixes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../appendixes/object_stores/">Appendix A - Common object stores for backups</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">CloudNativePG v1.24</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Release notes for CloudNativePG 1.20</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="release-notes-for-cloudnativepg-120">Release notes for CloudNativePG 1.20</h1>
<p>History of user-visible changes in the 1.20 minor release of CloudNativePG.</p>
<p>For a complete list of changes, please refer to the
<a href="https://github.com/cloudnative-pg/cloudnative-pg/commits/release-1.20">commits</a>
on the release branch in GitHub.</p>
<h2 id="version-1206">Version 1.20.6</h2>
<p><strong>Release date:</strong> Feb 2, 2024</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is expected to be the last release in the 1.20.X series.
Users are encouraged to update to a newer minor version soon.</p>
</div>
<p>Enhancements:</p>
<ul>
<li>Tailor ephemeral volume storage in a Postgres cluster using a claim template
  through the <code>ephemeralVolumeSource</code> option (#3678)</li>
<li>Introduce the <code>pgadmin4</code> command in the <code>cnpg</code> plugin for <code>kubectl</code>,
  providing a straightforward method to demonstrate connecting to a given
  database cluster and navigate its content in a local environment such as kind -
  for evaluation purposes only (#3701)</li>
<li>Allow customization of PostgreSQL's ident map file via the
  <code>.spec.postgresql.pg_ident</code> stanza, through a list of user name maps (#3534)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Prevent an unrecoverable issue with <code>pg_rewind</code> failing due to
  <code>postgresql.auto.conf</code> being read-only on clusters where the <code>ALTER SYSTEM</code>
  SQL command is disabled - the default (#3728)</li>
<li>Reduce the risk of disk space shortage when using the import facility of the
  <code>initdb</code> bootstrap method, by disabling the durability settings in the PostgreSQL
  instance for the duration of the import process (#3743)</li>
<li>Avoid pod restart due to erroneous resource quantity comparisons, e.g. "1 !=
  1000m"  (#3706)</li>
<li>Properly escape reserved characters in <code>pgpass</code> connection fields (#3713)</li>
<li>Prevent systematic rollout of pods due to considering zero and nil different
  values in <code>.spec.projectedVolumeTemplate.sources</code> (#3647)</li>
</ul>
<h2 id="version-1205">Version 1.20.5</h2>
<p><strong>Release date:</strong> Dec 21, 2023</p>
<p>Security:</p>
<ul>
<li>By default, TLSv1.3 is now enforced on all PostgreSQL 12 or higher
  installations. Additionally, users can configure the <code>ssl_ciphers</code>,
  <code>ssl_min_protocol_version</code>, and <code>ssl_max_protocol_version</code> GUCs (#3408).</li>
<li>Integration of Docker image scanning with Dockle and Snyk to enhance security
  measures (#3300).</li>
</ul>
<p>Enhancements:</p>
<ul>
<li>Improved reconciliation of external clusters (#3533).</li>
<li>Introduction of the ability to enable/disable the <code>ALTER SYSTEM</code> command (#3535).</li>
<li>Support for Prometheus' dynamic relabeling through the
  <code>podMonitorMetricRelabelings</code> and <code>podMonitorRelabelings</code> options in the
  <code>.spec.monitoring</code> stanza of the <code>Cluster</code> and <code>Pooler</code> resources (#3075).</li>
<li>Elimination of the use of the <code>PGPASSFILE</code> environment variable when
  establishing a network connection to PostgreSQL (#3522).</li>
<li>Improved <code>cnpg report</code> plugin command by collecting a cluster's PVCs (#3357).</li>
<li>Enhancement of the <code>cnpg status</code> plugin command, providing information about
  managed roles, including alerts (#3310).</li>
<li>Connection pooler:<ul>
<li>Scaling down instances of a <code>Pooler</code> resource to 0 is now possible (#3517).</li>
<li>Addition of the <code>cnpg.io/podRole</code> label with a value of 'pooler' to every
  pooler deployment, differentiating them from instance pods (#3396).</li>
</ul>
</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Reconciliation of metadata, annotations, and labels of <code>PodDisruptionBudget</code>
  resources (#3312 and #3434).</li>
<li>Reconciliation of the metadata of the managed credential secrets (#3316).</li>
<li>Resolution of a bug in the backup snapshot code where an error reading the
  body would be handled as an overall error, leaving the backup process
  indefinitely stuck (#3321).</li>
<li>Implicit setting of online backup with the <code>cnpg backup</code> plugin command when
  either <code>immediate-checkpoint</code> or <code>wait-for-archive</code> options are requested (#3449).</li>
<li>Disabling of wal_sender_timeout when joining through pg_basebackup (#3586)</li>
<li>Reloading of secrets used by external clusters (#3565)</li>
<li>Connection pooler:<ul>
<li>Ensuring the controller watches all secrets owned by a <code>Pooler</code> resource (#3428).</li>
<li>Reconciliation of <code>RoleBinding</code> for <code>Pooler</code> resources (#3391).</li>
<li>Reconciliation of <code>imagePullSecret</code> for <code>Pooler</code> resources (#3389).</li>
<li>Reconciliation of the service of a <code>Pooler</code> and addition of the required labels (#3349).</li>
<li>Extension of <code>Pooler</code> labels to the deployment as well, not just the pods (#3350).</li>
</ul>
</li>
</ul>
<p>Changes:</p>
<ul>
<li>Default operand image set to PostgreSQL 16.1 (#3270).</li>
</ul>
<h2 id="version-1204">Version 1.20.4</h2>
<p><strong>Release date:</strong> Nov 3, 2023</p>
<p>Enhancements:</p>
<ul>
<li>Enhance the <code>status</code> command of the <code>cnpg</code> plugin for <code>kubectl</code> with progress
  information on active streaming base backups (#3101)</li>
<li>Allow the configuration of <code>max_prepared_statements</code> with the pgBouncer
  <code>Pooler</code> resource (#3174)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Suspend WAL archiving during a switchover and resume it when it is completed
  (#3227)</li>
<li>Ensure that the instance manager always uses <code>synchronous_commit = local</code>
  when managing the PostgreSQL cluster (#3143)</li>
<li>Custom certificates for streaming replication user through
  <code>.spec.certificates.replicationTLSSecret</code> are now working (#3209)</li>
<li>Set the <code>cnpg.io/cluster</code> label to the <code>Pooler</code> pods (#3153)</li>
</ul>
<p>Changes:</p>
<ul>
<li>Stop using the <code>postgresql.auto.conf</code> file inside PGDATA to control Postgres
  replication settings, and replace it with a file named <code>override.conf</code> (#2812)</li>
</ul>
<p>Technical enhancements:</p>
<ul>
<li>Use extended query protocol for PostgreSQL in the instance manager (#3152)</li>
</ul>
<h2 id="version-1203">Version 1.20.3</h2>
<p><strong>Release date:</strong> Oct 11, 2023</p>
<p>Important Changes:</p>
<ul>
<li>Change the default value of <code>stopDelay</code> to 1800 seconds instead of 30 seconds
  (#2848)</li>
<li>Introduce a new parameter, called <code>smartShutdownTimeout</code>, to control the
  window of time reserved for the smart shutdown of Postgres to complete; the
  general formula to compute the overall timeout to stop Postgres is
  <code>max(stopDelay -  smartShutdownTimeout, 30)</code> (#2848)</li>
<li>Change the default value of <code>startDelay</code> to 3600, instead of 30 seconds
  (#2847)</li>
<li>Replace the livenessProbe initial delay with a more proper Kubernetes
  startup probe to deal with the start of a Postgres server (#2847)</li>
<li>Change the default value of <code>switchoverDelay</code> to 3600 seconds instead of
  40000000 seconds (#2846)</li>
<li>Stop supporting the <code>postgresql</code> label - replaced by <code>cnpg.io/cluster</code> in
  1.18 (#2744)</li>
</ul>
<p>Security:</p>
<ul>
<li>Add a default <code>seccompProfile</code> to the operator deployment (#2926)</li>
</ul>
<p>Enhancements:</p>
<ul>
<li>Introduce the <code>cnpg.io/coredumpFilter</code> annotation to control the content of a
  core dump generated in the unlikely event of a PostgreSQL crash, by default
  set to exclude shared memory segments from the dump (#2733)</li>
<li>Allow to configure ephemeral-storage limits for the shared memory and
  temporary data ephemeral volumes (#2830)</li>
<li>Validate resource limits and requests through the webhook (#2663)</li>
<li>Ensure that PostgreSQL's <code>shared_buffers</code> are coherent with the pods'
  allocated memory resources (#2840)</li>
<li>Add <code>uri</code> and <code>jdbc-uri</code> fields in the credential secrets to facilitate
  developers when connecting their applications to the database (#2186)</li>
<li>Add a new phase <code>Waiting for the instances to become active</code> for finer
  control of a cluster's state waiting for the replicas to be ready (#2612)</li>
<li>Improve detection of Pod rollout conditions through the <code>podSpec</code> annotation
  (#2243)</li>
<li>Add primary timestamp and uptime to the kubectl plugin’s <code>status</code> command
  (#2953)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Ensure that the primary instance is always recreated first by prioritizing
  ready PVCs with a primary role (#2544)</li>
<li>Honor the <code>cnpg.io/skipEmptyWalArchiveCheck</code> annotation during recovery to
  bypass the check for an empty WAL archive (#2731)</li>
<li>Prevent a cluster from being stuck when the PostgreSQL server is down but the
  pod is up on the primary (#2966)</li>
<li>Avoid treating the designated primary in a replica cluster as a regular HA
  replica when replication slots are enabled (#2960)</li>
<li>Reconcile services every time the selectors change or when labels/annotations
  need to be changed (#2918)</li>
<li>Defaults to <code>app</code> both the owner and database during recovery bootstrap
  (#2957)</li>
<li>Avoid write-read concurrency on cached cluster (#2884)</li>
<li>Remove empty items, make them unique and sort in the <code>ResourceName</code> sections
  of the generated roles (#2875)</li>
<li>Ensure that the <code>ContinuousArchiving</code> condition is properly set to 'failed'
  in case of errors (#2625)</li>
<li>Make the <code>Backup</code> resource reconciliation cycle more resilient on
  interruptions by stopping only if the backup is completed or failed (#2591)</li>
<li>Reconcile PodMonitor <code>labels</code> and <code>annotations</code> (#2583)</li>
<li>Fix backup failure due to missing RBAC <code>resourceNames</code> on the <code>Role</code> object
  (#2956)</li>
<li>
<p>Observability:</p>
<ul>
<li>Add TCP port label to default <code>pg_stat_replication</code> metric (#2961)</li>
<li>Fix the <code>pg_wal_stat</code> default metric for Prometheus (#2569)</li>
<li>Improve the <code>pg_replication</code> default metric for Prometheus (#2744 and
  #2750)</li>
<li>Use <code>alertInstanceLabelFilter</code> instead of <code>alertName</code> in the provided
  Grafana dashboard</li>
<li>Enforce <code>standard_conforming_strings</code> in metric collection (#2888)</li>
</ul>
</li>
</ul>
<p>Changes:</p>
<ul>
<li>Set the default operand image to PostgreSQL 16.0</li>
<li>Fencing now uses PostgreSQL’s fast shutdown instead of smart shutdown to halt
  an instance (#3051)</li>
<li>Rename webhooks from kb.io to cnpg.io group (#2851)</li>
<li>Replace the <code>cnpg snapshot</code> command with <code>cnpg backup -m volumeSnapshot</code> for
  the <code>kubectl</code> plugin</li>
<li>Let the <code>cnpg hibernate</code> plugin command use the
  <code>ClusterManifestAnnotationName</code> and <code>PgControldataAnnotationName</code> annotations
  on PVCs (#2657)</li>
<li>Add the <code>cnpg.io/instanceRole</code> label while deprecating the existing <code>role</code>
  label (#2915)</li>
</ul>
<p>Technical enhancements:</p>
<ul>
<li>Replace <code>k8s-api-docgen</code> with <code>gen-crd-api-reference-docs</code> to automatically
  build the API reference documentation (#2606)</li>
</ul>
<h2 id="version-1202">Version 1.20.2</h2>
<p><strong>Release date:</strong> July 27, 2023</p>
<p>Enhancements:</p>
<ul>
<li>New <code>logs</code> command in the kubectl plugin, to retrieve or follow the logs
  of all pods in a cluster (#2375)</li>
<li>Add support for specifying priorityClassName in pods, helping Kubernetes
  make scheduling decisions (#2043)</li>
<li>Add a metric and status field to monitor node usage by a CloudNativePG cluster (#2257)</li>
<li>Various enhancements to the documentation:<ul>
<li>Add troubleshooting instructions relating to hugepages (#1390)</li>
<li>Extend the FAQs page (#2344)</li>
</ul>
</li>
</ul>
<p>Technical enhancements:</p>
<ul>
<li>Add a check at the start of the restore process to ensure it can proceed; give
  improved error diagnostics if it cannot (#2419)</li>
<li>Improve handling of non-expiring passwords in managed roles (#2334)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Ensure the logic of setting the recovery target matches that of Postgres (#2460)</li>
<li>Prevent taking over service accounts not owned by the cluster, by setting
  ownerMetadata only during service account creation (#2462)</li>
<li>Ensure correct permissions of the PGDATA directory for initdb and restore (#2384)</li>
<li>Prevent a possible crash of the instance manager during the configuration reload (#2393)</li>
<li>Prevent the LastFailedArchiveTime alert from triggering if a new backup has been
  successful after the failed ones (#1751)</li>
<li>Prevent services from targeting non-instance pods (#2336)</li>
</ul>
<p>Security:</p>
<ul>
<li>Updated all project dependencies to the latest versions</li>
</ul>
<h2 id="version-1201">Version 1.20.1</h2>
<p><strong>Release date:</strong> June 12, 2023</p>
<p>Enhancements:</p>
<ul>
<li>Add the <code>snapshot</code> command to the <code>cnpg</code> plugin to create a consistent cold
  backup of the cluster from a standby using the Kubernetes <code>VolumeSnapshot</code>
  standard resource (#1960)</li>
<li>First implementation of recovery from a set of CSI VolumeSnapshot resources
  via the <code>.spec.bootstrap.recovery.volumeSnapshot</code> stanza (#1960)</li>
<li>Add <code>pg_failover_slots</code> to managed extensions (#2057)</li>
<li>Improved Grafana dashboard with updated instructions in the documentation and
  the quickstart guide (#1916)</li>
<li>Introduce the <code>schemaOnly</code> option in the <code>import</code> stanza, to avoid exporting
  and importing data when you bootstrap a new Postgres Cluster from one or more
  existing databases (#2234)</li>
<li>Add support for TopologySpreadConstraints to manage scheduling of instance
  pods (#2202)</li>
<li>Add <code>PodMonitor</code> support to the <code>Pooler</code>for PgBouncer (#2034)</li>
<li>Add option to override the default Kubernetes scheduler (#2013)</li>
<li>Allow configuration of deployment strategy of a <code>Pooler</code> resource (#1983)</li>
<li>Update default PostgreSQL version to 15.3 (#2022)</li>
<li>Use PgBouncer 1.19 by default (#2018)</li>
</ul>
<p>Technical enhancements:</p>
<ul>
<li>Updated k8s kind tested versions (#2054)</li>
<li>Declarative roles should ignore passwords if not set, easing management of
  previously existing roles  (#2029)</li>
<li>Use separate transactions to reconcile role credentials. Before this patch,
  the operator would revert the synchronization of all roles if one failed
  (#2004)</li>
<li>Ensure fencing is removed during cluster restore (#1987)</li>
<li>Improve logging when deleting Pods (#2136)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Fix unbound variable with k3s engine which could prevent setup on K3’s (#2157)</li>
<li>Report the correct PG version in the metrics (#2126)</li>
<li>Use the correct walStorage key in the documentation (#2140)</li>
<li>Halt reconciliation when the operator cannot connect with the instances, and
  provide a clear diagnostic on such occasions. This will help clarify cases
  where network issues obstruct normal operation of CloudNativePG (#2145),
  (#2233), and (#2242)</li>
</ul>
<h2 id="version-1200">Version 1.20.0</h2>
<p><strong>Release date:</strong> April 27, 2023</p>
<div class="admonition important">
<p class="admonition-title">Important changes from previous versions</p>
<p>CloudNativePG 1.20 introduces some changes to the default behavior of a
few features for newly created <code>Cluster</code> resources, compared to previous
versions of the operator. The goal of these changes is to improve the
resilience of a Postgres cluster out of the box through convention over
configuration. For clusters with one or more replicas:</p>
<ul>
<li>Backup from standby is now enabled by default, unless <code>target</code> is
    explicitly set to <code>primary</code></li>
<li>Restart of the primary is now the default method to complete the
    unsupervised rolling update procedure (<code>primaryUpdateMethod</code>
    defaults to <code>restart</code>, unless explicitly set to <code>switchover</code>)</li>
</ul>
<p>For further information, please refer to the "Installation and upgrades" section.</p>
</div>
<p>Features:</p>
<ul>
<li><strong>Declarative role management:</strong> introduce the <code>managed.roles</code> stanza in the
  <code>Cluster</code> spec to provide full lifecycle management of database roles, by
  providing an abstraction to the related DDL commands in PostgreSQL, such as
  <code>CREATE ROLE</code> and <code>ALTER ROLE</code> (#1524, #1793 and #1815)</li>
<li><strong>Declarative hibernation of a PostgreSQL cluster:</strong> introduce a new
  annotation called <code>cnpg.io/hibernation</code> to declaratively hibernate a
  PostgreSQL cluster by deleting all pods and keeping the PVCs only; the feature
  also implements the inverse procedure (#1657)</li>
</ul>
<p>Enhancements:</p>
<ul>
<li>Improve the <code>--logs</code> option of the <code>report</code> command of the <code>cnpg</code> plugin for
  <code>kubectl</code> to also include the previous logs where available (#1811)</li>
<li>The <code>-any</code> service is now disabled by default (#1755)</li>
</ul>
<p>Security:</p>
<ul>
<li>Enable customization of <code>SeccompProfile</code> through override via a local file (#1827)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Apply the PostgreSQL configuration provided by the user during the <code>initdb</code>
  bootstrap phase, before the server is started the first time (#1858)</li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
