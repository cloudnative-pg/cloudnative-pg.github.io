<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="The CloudNativePG Contributors" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Release notes for CloudNativePG 1.22 - CloudNativePG</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../css/override.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Release notes for CloudNativePG 1.22";
        var mkdocs_page_input_path = "release_notes/v1.22.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> CloudNativePG
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">CloudNativePG</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../before_you_start/">Before You Start</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../use_cases/">Use cases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../architecture/">Architecture</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation_upgrade/">Installation and upgrades</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../quickstart/">Quickstart</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../bootstrap/">Bootstrap</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../database_import/">Importing Postgres databases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../security/">Security</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../instance_manager/">Postgres instance manager</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../scheduling/">Scheduling</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../resource_management/">Resource management</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../failure_modes/">Failure Modes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../rolling_update/">Rolling Updates</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../replication/">Replication</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../backup/">Backup</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../backup_barmanobjectstore/">Backup on object stores</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../wal_archiving/">WAL archiving</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../backup_volumesnapshot/">Backup on volume snapshots</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../recovery/">Recovery</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../postgresql_conf/">PostgreSQL Configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../declarative_role_management/">Database Role Management</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../tablespaces/">Tablespaces</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../operator_conf/">Operator configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../cluster_conf/">Instance pod configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../storage/">Storage</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../labels_annotations/">Labels and annotations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../monitoring/">Monitoring</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../logging/">Logging</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../certificates/">Certificates</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../ssl_connections/">Client TLS/SSL connections</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../applications/">Connecting from an application</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../connection_pooling/">Connection pooling</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../replica_cluster/">Replica clusters</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../kubernetes_upgrade/">Kubernetes Upgrade</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../expose_pg_services/">Exposing Postgres Services</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../kubectl-plugin/">Kubectl Plugin</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../failover/">Automated failover</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/">Troubleshooting</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../fencing/">Fencing</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../declarative_hibernation/">Declarative hibernation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../postgis/">PostGIS</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../e2e/">End-to-End Tests</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../container_images/">Container Image Requirements</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../operator_capability_levels/">Operator capability levels</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../controller/">Custom Pod Controller</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../samples/">Examples</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../networking/">Networking</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../benchmarking/">Benchmarking</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../commercial_support/">Commercial support</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../faq/">Frequently Asked Questions (FAQ)</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../cloudnative-pg.v1/">API Reference</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../supported_releases/">Supported releases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../">Release notes</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Appendixes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../appendixes/object_stores/">Appendix A - Common object stores for backups</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">CloudNativePG</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Release notes for CloudNativePG 1.22</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="release-notes-for-cloudnativepg-122">Release notes for CloudNativePG 1.22</h1>
<p>History of user-visible changes in the 1.22 minor release of CloudNativePG.</p>
<p>For a complete list of changes, please refer to the
<a href="https://github.com/cloudnative-pg/cloudnative-pg/commits/release-1.22">commits</a>
on the release branch in GitHub.</p>
<h2 id="version-1222">Version 1.22.2</h2>
<p><strong>Release date:</strong> Mar 14, 2024</p>
<h3 id="enhancements">Enhancements</h3>
<ul>
<li>Allow customization of the <code>wal_level</code> GUC in PostgreSQL (#4020)</li>
<li>Add the <code>cnpg.io/skipWalArchiving</code> annotation to disable WAL archiving when
  set to <code>enabled</code> (#4055)</li>
<li>Enrich the <code>cnpg</code> plugin for <code>kubectl</code> with the <code>publication</code> and
  <code>subscription</code> command groups to imperatively set up PostgreSQL native
  logical replication (#4052)</li>
<li>Allow customization of <code>CERTIFICATE_DURATION</code> and <code>EXPIRING_CHECK_THRESHOLD</code>
  for automated management of TLS certificates handled by the operator (#3686)</li>
<li>Retrieve the correct architecture's binary from the corresponding catalog in
  the running operator image during in-place updates, enabling the operator to
  inject the correct binary into any Pod with a supported architecture (#3840)</li>
<li>Introduce initial support for tab-completion with the <code>cnpg</code> plugin for
  <code>kubectl</code> (#3875)</li>
</ul>
<h3 id="fixes">Fixes</h3>
<ul>
<li>Properly synchronize PVC group labels with those on the pods, a critical
  aspect when all pods are deleted and the operator needs to decide which Pod
  to recreate first (#3930)</li>
<li>Disable <code>wal_sender_timeout</code> when cloning a replica to prevent timeout errors
  due to slow connections (#4080)</li>
<li>Ensure that volume snapshots are ready before initiating recovery bootstrap
  procedures, preventing an error condition where recovery with incomplete
  backups could enter an error loop (#3663)</li>
<li>Prevent an error loop when unsetting connection limits in managed roles (#3832)</li>
<li>Resolve a corner case in hibernation where the instance pod has been deleted,
  but the cluster status still has the hibernation condition set to false (#3970)</li>
<li>Correctly detect Google Cloud capabilities for Barman Cloud (#3931)</li>
</ul>
<h3 id="security">Security</h3>
<ul>
<li>Use <code>Role</code> instead of <code>ClusterRole</code> for operator permissions in OLM,
  requiring fewer privileges when installed on a per-namespace basis (#3855,
  #3990)</li>
<li>Enforce fully-qualified object names in SQL queries for the PgBouncer pooler
  (#4080)</li>
</ul>
<h3 id="changes">Changes</h3>
<ul>
<li>Follow Kubernetes recommendations to switch from client-side to server-side
  application of manifests, requiring the <code>--server-side</code> option by default
  when installing the operator (#3729).</li>
<li>Set the default operand image to PostgreSQL 16.2 (#3823).</li>
</ul>
<h2 id="version-1221">Version 1.22.1</h2>
<p><strong>Release date:</strong> Feb 2, 2024</p>
<p>Enhancements:</p>
<ul>
<li>Tailor ephemeral volume storage in a Postgres cluster using a claim template
  through the <code>ephemeralVolumeSource</code> option (#3678)</li>
<li>Introduce the <code>pgadmin4</code> command in the <code>cnpg</code> plugin for <code>kubectl</code>,
  providing a straightforward method to demonstrate connecting to a given
  database cluster and navigate its content in a local environment such as kind -
  for evaluation purposes only (#3701)</li>
<li>Allow customization of PostgreSQL's ident map file via the
  <code>.spec.postgresql.pg_ident</code> stanza, through a list of user name maps (#3534)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Prevent an unrecoverable issue with <code>pg_rewind</code> failing due to
  <code>postgresql.auto.conf</code> being read-only on clusters where the <code>ALTER SYSTEM</code>
  SQL command is disabled - the default (#3728)</li>
<li>Proper recovery of tablespaces from volume snapshots (#3682)</li>
<li>Reduce the risk of disk space shortage when using the import facility of the
  <code>initdb</code> bootstrap method, by disabling the durability settings in the PostgreSQL
  instance for the duration of the import process (#3743)</li>
<li>Avoid pod restart due to erroneous resource quantity comparisons, e.g. "1 !=
  1000m"  (#3706)</li>
<li>Properly escape reserved characters in <code>pgpass</code> connection fields (#3713)</li>
<li>Prevent systematic rollout of pods due to considering zero and nil different
  values in <code>.spec.projectedVolumeTemplate.sources</code> (#3647)</li>
<li>Ensure configuration coherence by pruning from <code>postgresql.auto.conf</code> any
  options now incorporated into <code>override.conf</code> (#3773)</li>
</ul>
<h2 id="version-1220">Version 1.22.0</h2>
<p><strong>Release date:</strong> Dec 21, 2023</p>
<div class="admonition important">
<p class="admonition-title">Important changes from previous versions</p>
<p>This release introduces a significant change, disabling the default usage
of the <code>ALTER SYSTEM</code> command in PostgreSQL. For users upgrading from a
previous version who wish to retain the old behavior: please refer to the
<a href="../../installation_upgrade/">upgrade documentation</a> for detailed instructions.</p>
</div>
<p>Features:</p>
<ul>
<li>
<p><strong>Declarative Tablespaces</strong>: Introducing the <code>tablespaces</code> stanza in the
  <code>Cluster</code> spec, enabling comprehensive lifecycle management of PostgreSQL
  tablespaces for enhanced vertical scalability (#3410).</p>
</li>
<li>
<p><strong>Temporary Tablespaces</strong>: Adding the <code>.spec.tablespaces[*].temporary</code>
  option to facilitate the utilization of a tablespace for temporary database
  operations, by incorporating the name into the <code>temp_tablespaces</code> PostgreSQL
  parameter (#3464).</p>
</li>
</ul>
<p>Security:</p>
<ul>
<li>By default, TLSv1.3 is now enforced on all PostgreSQL 12 or higher
  installations. Additionally, users can configure the <code>ssl_ciphers</code>,
  <code>ssl_min_protocol_version</code>, and <code>ssl_max_protocol_version</code> GUCs (#3408).</li>
<li>Integration of Docker image scanning with Dockle and Snyk to enhance security
  measures (#3300).</li>
</ul>
<p>Enhancements:</p>
<ul>
<li>Improved reconciliation of external clusters (#3533).</li>
<li>Introduction of the ability to enable/disable the <code>ALTER SYSTEM</code> command (#3535).</li>
<li>Support for Prometheus' dynamic relabeling through the
  <code>podMonitorMetricRelabelings</code> and <code>podMonitorRelabelings</code> options in the
  <code>.spec.monitoring</code> stanza of the <code>Cluster</code> and <code>Pooler</code> resources (#3075).</li>
<li>Enhanced computation of the first recoverability point and last successful
  backup by considering volume snapshots alongside object-store backups (#2940). <!-- NO 1.20 --></li>
<li>Elimination of the use of the <code>PGPASSFILE</code> environment variable when
  establishing a network connection to PostgreSQL (#3522).</li>
<li>Improved <code>cnpg report</code> plugin command by collecting a cluster's PVCs (#3357).</li>
<li>Enhancement of the <code>cnpg status</code> plugin command, providing information about
  managed roles, including alerts (#3310).</li>
<li>Introduction of Red Hat UBI 8 container images for the operator, suitable for
  OLM deployments. <!-- NO 1.20 --></li>
<li>Connection pooler:<ul>
<li>Scaling down instances of a <code>Pooler</code> resource to 0 is now possible (#3517).</li>
<li>Addition of the <code>cnpg.io/podRole</code> label with a value of 'pooler' to every
  pooler deployment, differentiating them from instance pods (#3396).</li>
</ul>
</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Reconciliation of metadata, annotations, and labels of <code>PodDisruptionBudget</code>
  resources (#3312 and #3434).</li>
<li>Reconciliation of the metadata of the managed credential secrets (#3316).</li>
<li>Resolution of a bug in the backup snapshot code where an error reading the
  body would be handled as an overall error, leaving the backup process
  indefinitely stuck (#3321).</li>
<li>Implicit setting of online backup with the <code>cnpg backup</code> plugin command when
  either <code>immediate-checkpoint</code> or <code>wait-for-archive</code> options are requested (#3449).</li>
<li>Disabling of wal_sender_timeout when joining through pg_basebackup (#3586)</li>
<li>Reloading of secrets used by external clusters (#3565)</li>
<li>Connection pooler:<ul>
<li>Ensuring the controller watches all secrets owned by a <code>Pooler</code> resource (#3428).</li>
<li>Reconciliation of <code>RoleBinding</code> for <code>Pooler</code> resources (#3391).</li>
<li>Reconciliation of <code>imagePullSecret</code> for <code>Pooler</code> resources (#3389).</li>
<li>Reconciliation of the service of a <code>Pooler</code> and addition of the required labels (#3349).</li>
<li>Extension of <code>Pooler</code> labels to the deployment as well, not just the pods (#3350).</li>
</ul>
</li>
</ul>
<p>Changes:</p>
<ul>
<li>Default operand image set to PostgreSQL 16.1 (#3270).</li>
<li>The <code>ALTER SYSTEM</code> command is now disabled by default (#3545). <!-- NO 1.21, 1.20 --></li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
