<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="The CloudNativePG Contributors" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Release notes for CloudNativePG 1.15 - CloudNativePG v1.23</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../css/override.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Release notes for CloudNativePG 1.15";
        var mkdocs_page_input_path = "release_notes/old/v1.15.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> CloudNativePG v1.23
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">CloudNativePG</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../before_you_start/">Before You Start</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../use_cases/">Use cases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../architecture/">Architecture</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../installation_upgrade/">Installation and upgrades</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../quickstart/">Quickstart</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../image_catalog/">Image Catalog</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../bootstrap/">Bootstrap</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../database_import/">Importing Postgres databases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../security/">Security</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../instance_manager/">Postgres instance manager</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../scheduling/">Scheduling</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../resource_management/">Resource management</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../failure_modes/">Failure Modes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../rolling_update/">Rolling Updates</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../replication/">Replication</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../backup/">Backup</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../backup_barmanobjectstore/">Backup on object stores</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../wal_archiving/">WAL archiving</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../backup_volumesnapshot/">Backup on volume snapshots</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../recovery/">Recovery</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../postgresql_conf/">PostgreSQL Configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../declarative_role_management/">Database Role Management</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../tablespaces/">Tablespaces</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../operator_conf/">Operator configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../cluster_conf/">Instance pod configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../storage/">Storage</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../labels_annotations/">Labels and annotations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../monitoring/">Monitoring</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../logging/">Logging</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../certificates/">Certificates</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../ssl_connections/">Client TLS/SSL connections</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../applications/">Connecting from an application</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../connection_pooling/">Connection pooling</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../replica_cluster/">Replica clusters</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../kubernetes_upgrade/">Kubernetes Upgrade and Maintenance</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../kubectl-plugin/">Kubectl Plugin</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../failover/">Automated failover</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting/">Troubleshooting</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../fencing/">Fencing</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../declarative_hibernation/">Declarative hibernation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../postgis/">PostGIS</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../e2e/">End-to-End Tests</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../container_images/">Container Image Requirements</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../operator_capability_levels/">Operator capability levels</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../controller/">Custom Pod Controller</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../samples/">Examples</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../networking/">Networking</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../benchmarking/">Benchmarking</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../commercial_support/">Commercial support</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../faq/">Frequently Asked Questions (FAQ)</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../cloudnative-pg.v1/">API Reference</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../supported_releases/">Supported releases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../preview_version/">Preview Versions</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../">Release notes</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Appendixes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../appendixes/object_stores/">Appendix A - Common object stores for backups</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">CloudNativePG v1.23</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Release notes for CloudNativePG 1.15</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="release-notes-for-cloudnativepg-115">Release notes for CloudNativePG 1.15</h1>
<p>History of user-visible changes in the 1.15 minor release of CloudNativePG.</p>
<p>For a complete list of changes, please refer to the
<a href="https://github.com/cloudnative-pg/cloudnative-pg/commits/release-1.15">commits</a>
on the release branch in GitHub.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is expected to be the last release in the 1.15.X series. 
Users are encouraged to update to a newer minor version soon.</p>
</div>
<h2 id="version-1155">Version 1.15.5</h2>
<p><strong>Release date:</strong> Oct 6, 2022</p>
<p>Enhancements:</p>
<ul>
<li>Introduce <code>leaseDuration</code> and <code>renewDeadline</code> parameters in the controller
   manager to enhance configuration of the leader election in operator
   deployments (#759)</li>
<li>Improve the mechanism that checks that the backup object store is empty
   before archiving a WAL file for the first time: a new file called
   <code>.check-empty-wal-archive</code> is placed in the <code>PGDATA</code> immediately after
   the cluster is bootstrapped and it is then removed after the first WAL
   file is successfully archived</li>
</ul>
<p>Security:</p>
<ul>
<li>Explicitly set permissions of the instance manager binary that is copied in
  the <code>distroless/static:nonroot</code> container image, by using the
  <code>nonroot:nonroot</code> user (#754)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Make the cluster's conditions compatible with <code>metav1.Conditions</code> struct (#720)</li>
<li>Drop any active connection on a standby after it is promoted to primary (#737)</li>
<li>Honor <code>MAPPEDMETRIC</code> and <code>DURATION</code> metric types conversion in the native
  Prometheus exporter  (#765)</li>
</ul>
<h2 id="version-1154">Version 1.15.4</h2>
<p><strong>Release date:</strong> Sep 6, 2022</p>
<p>Enhancements:</p>
<ul>
<li>Enable configuration of low-level network TCP settings in the PgBouncer
  connection pooler implementation (#584)</li>
<li>Make sure that the <code>cnpg.io/instanceName</code> and the <code>cnpg.io/podRole</code> labels
  are always present on pods and PVCs (#632 and #680)</li>
<li>Propagate the <code>role</code> label of an instance to the underlying PVC (#634)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Prevent multiple in-place upgrade processes of the operator from running
  simultaneously by atomically checking whether another one is in progress (#655)</li>
<li>Avoid using a hardcoded file name to store the newly uploaded instance
  manager, preventing a possible race condition during online upgrades of the
  operator (#660)</li>
<li>Prevent a panic from happening when invoking <code>GetAllAccessibleDatabases</code>
  (#641)</li>
</ul>
<h2 id="version-1153">Version 1.15.3</h2>
<p><strong>Release date:</strong> Aug 12, 2022</p>
<p>Enhancements:</p>
<ul>
<li>Enable the configuration of the <code>huge_pages</code> option for PostgreSQL (#456)</li>
<li>Enhance log during promotion and demotion, after a failover or a switchover,
  by printing the time elapsed between the request of promotion and the actual
  availability for writes (#371)</li>
<li>Add the <code>instanceName</code> and <code>clusterName</code> labels on jobs, pods, and PVCs to
  improve interaction with these resources (#534)</li>
<li>Add instructions on how to create PostGIS clusters (#570)</li>
</ul>
<p>Security:</p>
<ul>
<li>Explicitly assign <code>securityContext</code> to the <code>Pooler</code> deployment (#485)</li>
<li>Add read timeout values to the internal web servers to prevent Slowloris DDoS (#437)</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Use the correct delays for restarts (<code>stopDelay</code>) and for switchover
  (<code>switchoverDelay</code>), as they were erroneously swapped before. This is an
  important fix, as it might block indefinitely restarts if <code>switchoverDelay</code> is
  not set and uses the default value of 40000000 seconds (#531)</li>
<li>Prevent the metrics collector from causing panic when the query returns an
  error (#396)</li>
<li>Removing an unsafe debug message that was referencing an unchecked pointer,
  leading in some cases to segmentation faults regardless of the log level (#491)</li>
<li>Prevent panic when fencing in case the cluster had no annotation (#512)</li>
<li>Avoid updating the CRD if a TLS certificate is not changed (#501)</li>
<li>Handle conflicts while injecting a certificate in the CRD (#547)</li>
<li>Backup and recovery:<ul>
<li>Correctly pass object store credentials in Google Cloud (#454)</li>
</ul>
</li>
</ul>
<p>Minor changes:</p>
<ul>
<li>Set the default operand image to PostgreSQL 15.0</li>
</ul>
<h2 id="version-1152">Version 1.15.2</h2>
<p><strong>Release date:</strong> Jul 7, 2022 (patch release)</p>
<p>Enhancements:</p>
<ul>
<li>Improve logging of the instance manager during switchover and failover</li>
<li>Require Barman &gt;= 3.0.0 for future support of PostgreSQL 15 in backup
  and recovery</li>
</ul>
<p>Changes:</p>
<ul>
<li>Set the default operand image to PostgreSQL 15.0</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Fix the initialization order inside the <code>WithActiveInstance</code> function that
  starts the CSV log pipe for the PostgreSQL server, ensuring proper logging in
  the cluster initialization phase - this is especially useful in bootstrap
  operations like recovery from a backup are failing (before this patch, such
  logs were not sent to the standard output channel and were permanently lost)</li>
<li>Avoid an unnecessary switchover when a hot standby sensitive parameter is
  decreased, and the primary has already restarted</li>
<li>Properly quote role names in <code>ALTER ROLE</code> statements</li>
<li>Backup and recovery:<ul>
<li>Fix the algorithm detecting the closest Barman backup for PITR, which was
  comparing the requested recovery timestamp with the backup start instead
  of the end</li>
<li>Fix Point in Time Recovery based on a transaction ID, a named restore
  point, or the “immediate” target by providing a new field called
  <code>backupID</code> in the <code>recoveryTarget</code> section</li>
<li>Fix encryption parameters invoking <code>barman-cloud-wal-archive</code> and
  <code>barman-cloud-backup</code> commands</li>
<li>Stop ignoring <code>barmanObjectStore.serverName</code> option when recovering from
  a backup object store using a server name that doesn’t match the current
  cluster name</li>
</ul>
</li>
<li><code>cnpg</code> plug-in:<ul>
<li>Make sure that the plug-in complies with the <code>-n</code> parameter when
  specified by the user</li>
<li>Fix the <code>status</code> command to sort results and remove variability in the
  output</li>
</ul>
</li>
</ul>
<h2 id="version-1151">Version 1.15.1</h2>
<p><strong>Release date:</strong> May 27, 2022 (patch release)</p>
<p>Minor changes:</p>
<ul>
<li>Enable configuration of the <code>archive_timeout</code> setting for PostgreSQL, which
  was previously a fixed parameter (by default set to 5 minutes)</li>
<li>Introduce a new field called <code>backupOwnerReference</code> in the <code>scheduledBackup</code>
  resource to set the ownership reference on the created backup resources, with
  possible values being <code>none</code> (default), <code>self</code> (objects owned by the scheduled
  backup object), and <code>cluster</code> (owned by the Postgres cluster object)</li>
<li>Introduce automated collection of <code>pg_stat_wal</code> metrics for PostgreSQL 14 or
  higher in the native Prometheus exporter</li>
<li>Set the default operand image to PostgreSQL 15.0</li>
</ul>
<p>Fixes:</p>
<ul>
<li>Fix fencing by killing orphaned processes related to <code>postgres</code></li>
<li>Enable the CSV log pipe inside the <code>WithActiveInstance</code> function to collect
  logs from recovery bootstrap jobs and help in the troubleshooting phase</li>
<li>Prevent bootstrapping a new cluster with a non-empty backup object store,
  removing the risk of overwriting existing backups</li>
<li>With the <code>recovery</code> bootstrap method, make sure that the recovery object
  store and the backup object store are different to avoid overwriting existing
  backups</li>
<li>Re-queue the reconciliation loop if the RBAC for backups is not yet created</li>
<li>Fix an issue with backups and the wrong specification of the cluster name
  property</li>
<li>Ensures that operator pods always have the latest certificates in the case of
  a deployment of the operator in high availability, with more than one replica</li>
<li>Fix the <code>cnpg report operator</code> command to correctly handle the case of a
  deployment of the operator in high availability, with more than one replica</li>
<li>Properly propagate changes in the cluster’s <code>inheritedMetadata</code> set of labels
  and annotations to the related resources of the cluster without requiring a
  restart</li>
<li>Fix the <code>cnpg</code> plugin to correctly parse any custom configmap and secret name
  defined in the operator deployment, instead of relying just on the default
  values</li>
<li>Fix the local building of the documentation by using the <code>minidocks/mkdocs</code> image
  for <code>mkdocs</code></li>
</ul>
<h2 id="version-1150">Version 1.15.0</h2>
<p><strong>Release date:</strong> 21 April 2022</p>
<p>Features:</p>
<ul>
<li><strong>Fencing:</strong> Introduction of the fencing capability for a cluster or a given
  set of PostgreSQL instances through the <code>cnpg.io/fencedInstances</code>
  annotation, which, if not empty, disables switchover/failovers in the cluster;
  fenced instances are shut down and the pod is kept running (while considered
  not ready) for inspection and emergencies</li>
<li><strong>LDAP authentication:</strong> Allow LDAP Simple Bind and Search+Bind configuration
  options in the <code>pg_hba.conf</code> to be defined in the Postgres cluster spec
  declaratively, enabling the optional use of Kubernetes secrets for sensitive
  options such as <code>ldapbindpasswd</code></li>
<li>Introduction of the <code>primaryUpdateMethod</code> option, accepting the values of
  <code>switchover</code> (default) and <code>restart</code>, to be used in case of unsupervised
  <code>primaryUpdateStrategy</code>; this method controls what happens to the primary
  instance during the rolling update procedure</li>
<li>New <code>report</code> command in the <code>kubectl cnp</code> plugin for better diagnosis and
  more effective troubleshooting of both the operator and a specific Postgres
  cluster</li>
<li>Prune those <code>Backup</code> objects that are no longer in the backup object store</li>
<li>Specification of target timeline and <code>LSN</code> in Point-In-Time Recovery
  bootstrap method</li>
<li>Support for the <code>AWS_SESSION_TOKEN</code> authentication token in AWS S3 through
  the <code>sessionToken</code> option</li>
<li>Default image name for PgBouncer in <code>Pooler</code> pods set to
  <code>quay.io/enterprisedb/pgbouncer:1.17.0</code></li>
</ul>
<p>Fixes:</p>
<ul>
<li>Base backup detection for Point-In-Time Recovery via <code>targetTime</code> correctly
  works now, as previously a target prior to the latest available backup was
  not possible (the detection algorithm was always wrong by selecting the last
  backup as a starting point)</li>
<li>Improved resilience of hot standby sensitive parameters by relying on the
  values the operator collects from <code>pg_controldata</code></li>
<li>Intermediate certificates handling has been improved by properly discarding invalid entries,
  instead of throwing an invalid certificate error</li>
<li>Prometheus exporter metric collection queries in the databases are now
  committed instead of rolled back (this might result in a change in the number
  of rolled back transactions that are visible from downstream dashboards,
  where applicable)</li>
</ul>
<p>Version 1.15.0 is the first release of CloudNativePG. Previously, this software
was called EDB Cloud Native PostgreSQL (now EDB Postgres for Kubernetes). If you
are looking for information about a previous release, please refer to the
<a href="https://www.enterprisedb.com/docs/postgres_for_kubernetes/latest/">EDB documentation</a>.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
